---
title: "3-1, 3-2ì¥ ë°ì´í„° ì‹œê°í™”"
format: html
editor: visual
---

â–ª ì •ë³´ì˜ ì €ì¥ê³¼ ì „ì†¡ : ì •ë³´ëŸ‰ì˜ ì¸¡ì •

    â€¢ í´ë¡œë“œ ì„€ë„Œì˜ ê³µì‹: ğ¼(ğ‘¥) = âˆ’ log2 ğ‘(ğ‘¥)
      - ì„¸ìƒì—ì„œ ê°€ì¥ ì¤‘ìš”í•œ ê³µì‹ ì¤‘ í•˜ë‚˜: ë””ì§€í„¸ ì •ë³´ í†µì‹ ì˜ ì‹œëŒ€ë¥¼ ì—° ê³µì‹.

    â€¢ ì •ë³´ì˜ ìš©ëŸ‰ì€ ì–´ë–¤ ì‚¬ê±´ ğ‘¥ê°€ ë°œìƒí•  í™•ë¥  ğ‘(ğ‘¥)ë¡œ ê²°ì •í•  ìˆ˜ ìˆë‹¤.
      - ë‚´ì¼ ì•„ì¹¨ì— í•´ê°€ ë™ìª½ì—ì„œ ëœ° ê²ƒì´ë‹¤: ì •ë³´ëŸ‰ì´ ë§¤ìš° ì ìŒ.
      - ë‚´ì¼ ì•„ì¹¨ì— í•´ê°€ ì„œìª½ì—ì„œ ëœ° ê²ƒì´ë‹¤: ì •ë³´ëŸ‰ì´ ë§¤ìš° ë§ìŒ.

### ë°ì´í„°ë¥¼ ì´í•´í•˜ëŠ” ë°©ë²• :

    â€¢ ê¸°ìˆ ì  í†µê³„ : Descriptive Statistics

      - ì¸¡ì •ì´ë‚˜ ì‹¤í—˜ì„ í†µí•´ ìˆ˜ì§‘í•œ ë°ì´í„°ë¥¼ ì •ë¦¬, ìš”ì•½, í•´ì„, í‘œí˜„í•˜ëŠ” ë°©ë²•
      - í‰ê· (mean), ì¤‘ì•™ê°’(median), ì‚¬ë¶„ìœ„ê°’(quartile), ë°±ë¶„ìœ„ê°’(percentile)
      - ë¶„ì‚°(variation), í‘œì¤€í¸ì°¨(standard deviation)

    â€¢ ì¶”ë¡ ì  í†µê³„ : Inferential Statistics

      - ìˆ˜ì§‘í•œ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë¯¸ë˜ë¥¼ ì¶”ë¡ í•˜ê³  ì˜ˆì¸¡í•˜ëŠ” ë° ì‚¬ìš©í•˜ëŠ” ë°©ë²•
      - ëª¨ì§‘ë‹¨(population)ê³¼ í‘œë³¸ì¡°ì‚¬(sampling)
      - ì¶”ì •(estimation)ê³¼ ê°€ì„¤ê²€ì •(testing hypothesis)

â–ª ì•¤ìŠ¤ì½¤ì˜ 4ì¤‘ì£¼ : Anscombe's Quartet

      â€¢ ë°ì´í„° ì‹œê°í™”ëŠ” ê¸°ìˆ ì  í†µê³„ë¡œëŠ” ì•Œ ìˆ˜ ì—†ëŠ” ì •ë³´ë¥¼ ë³¼ ìˆ˜ ìˆë‹¤.

```{r}
library(tidyverse)
# str(diamonds)
# str(mpg)

# Anscombe's Quartet
anscombe
ans <- anscombe
mean(ans$x1)
mean(ans$x2)
mean(ans$x3)
mean(ans$x4)

mean(ans$y1)
mean(ans$y2)
mean(ans$y3)
mean(ans$y4)

# ìƒê´€ê³„ìˆ˜
cor(ans$x1, ans$y1)
cor(ans$x2, ans$y2)
cor(ans$x3, ans$y3)
cor(ans$x4, ans$y4)

# ì„ í˜•íšŒê·€
lm(y1 ~ x1, data = ans)
lm(y2 ~ x2, data = ans)
lm(y3 ~ x3, data = ans)
lm(y4 ~ x4, data = ans)
# ==> ê¸°ìˆ ì  í†µê³„ë¡œ ë³´ë©´ ì „ë¶€ ë¹„ìŠ·í•œ ìˆ˜ì¹˜

# ì‹œê°í™”
par(mfrow = c(2,2))
plot(ans$x1, ans$y1, col = 'orange', pch = 19)
abline(lm(y1 ~ x1, data = ans), col = "tomato")

plot(ans$x2, ans$y2, col = 'orange', pch = 19)
abline(lm(y2 ~ x2, data = ans), col = "tomato")

plot(ans$x3, ans$y3, col = 'orange', pch = 19)
abline(lm(y3 ~ x3, data = ans), col = "tomato")

plot(ans$x4, ans$y4, col = 'orange', pch = 19)
abline(lm(y4 ~ x4, data = ans), col = "tomato")
par(mfrow = c(1,1))
# ==> ì‹œê°í™”í•˜ë©´ ì „í˜€ ë‹¤ë¥¸ ëª¨ìŠµ
```

â–ª ë°ì´í„°ì‚¬ìš°ë£¨ìŠ¤ : Datasaurus

      â€¢ ê¸°ìˆ ì  í†µê³„ë¥¼ ë¯¿ì§€ ë§ê³ , ë°ì´í„°ë¥¼ ì‹œê°í™”í•´ë¼! (by Alberto Cairo)

```{r}
# install.packages("datasauRus")
library(datasauRus)

# data(package = "datasauRus")
dd <- datasaurus_dozen
str(dd)
unique(dd$dataset)

plot(y ~ x, data = dd, pch = 19, col = "tomato")

plot(y ~ x, data = subset(dd, dataset == "dino"), 
     pch = 19, col = "tomato")

ggplot(data = subset(dd, dataset == "dino"),
       mapping = aes(x = x, y = y)) + geom_point()

ggplot(data = dd, mapping = aes(x = x, y = y)) +
  geom_point(mapping = aes(color = dataset)) +
  facet_wrap(~ dataset, nrow = 4)
```

â–ª tidyverseì™€ ggplot2

      â€¢ tidyverse: í•´ë“¤ë¦¬ ìœ„ì»´ì´ ëª¨ì•„ ë†“ì€ ë°ì´í„° ê³¼í•™ì„ ìœ„í•œ R íŒ¨í‚¤ì§€ë“¤
      â€¢ ggplot2: tidyverseì˜ ì„¸ê³„ì—ì„œ ì‹œê°í™”ë¥¼ ë‹´ë‹¹í•˜ëŠ” íŒ¨í‚¤ì§€

### ggplot

```{r}
p <- ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + 
  geom_point()
p

# class >> ë²”ì£¼í˜• ë³€ìˆ˜
# alpha >> íˆ¬ëª…ë„, shape >> ëª¨ì–‘

# ë²„ë¸” ì°¨íŠ¸, ìƒ‰ìƒê³¼ í¬ê¸°, ëª¨ì–‘, íˆ¬ëª…ë„ë¡œ ì •ë³´ì˜ ì°¨ì´ ì‹œê°í™”
p + geom_point(mapping = aes(color = class, size = class, shape = class, alpha = 0.3))

p + geom_point(mapping = aes(color = class)) + facet_wrap(~ class, nrow = 2)

p + geom_point(color = 'tomato') + facet_grid(drv ~ cyl)

# jitter ì ì´ ê²¹ì³ ìˆìœ¼ë©´ í”ë“¤ì–´ì„œ ë³¼ ìˆ˜ ìˆê²Œ
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy, color = class), 
             position = "jitter")
```

### geom : geometric object

```{r}
# smooth >> ì¶”ì„¸ì„ 
p <- ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + 
  geom_point()

p + geom_point(color = "blue") +
  geom_smooth(color = "cyan")

p + geom_point(mapping = aes(color = class)) +
  geom_smooth(color = "cyan")
# => ì‹œê°í™” ìë£Œë¥¼ ë³´ë‹ˆ ë‹¤í•­íšŒê·€ê°€ ìœ ë¦¬í•´ë³´ì„.
```

### geom_bar()

```{r}
p <- ggplot(data = diamonds)
# diamondsì˜ cut : geom_point() ì—ëŸ¬ ë°œìƒ
# geom_bar xì¶•ë§Œ ì•Œë©´ count ìë™ìœ¼ë¡œ, ëˆ„ì  ë§‰ëŒ€ ê·¸ë˜í”„
p + geom_bar(mapping = aes(x = cut), fill = "steelblue")
p + stat_count(mapping = aes(x = cut), fill = 'steelblue')

p + geom_bar(mapping = aes(x = cut, fill = clarity))
p + geom_bar(mapping = aes(x = cut, fill = clarity),
             position = "fill")
p + geom_bar(mapping = aes(x = cut, fill = clarity),
             position = "dodge")
```

### geom_boxplot()

```{r}
p <- ggplot(mpg, mapping = aes(x = class, y = hwy))
p + geom_boxplot()

p + geom_boxplot(fill = "lightyellow") +
coord_flip() # Coordinates flip
```

### coord_polar()

```{r}
p <- ggplot(data = diamonds, mapping = aes(x = cut, fill = cut))
p + geom_bar(show.legend = F, width = 1) # width : ë„“ì´

p + geom_bar(show.legend = F, width = 1) +
  labs(x = NULL, Y = NULL) +
  theme(aspect.ratio = 1) +
  coord_polar()

p + geom_bar(show.legend = F, width = 1) +
  coord_polar()
```

### geom_polygon()

```{r}
world <- map_data("world")
world

ggplot(world, aes(long, lat, group = group)) +
  geom_polygon(fill = "lightyellow", color = "blue")
```

```{r}
# install.packages("ggrepel")
str(mpg)
sd(mpg[mpg$hwy > mean(mpg$hwy), c(1, 2, 9, 11)]$hwy)

v <- c(10, 30, 50, 20, 40)
sort(v)

best.in.class <- mpg %>% # %>% íŒŒì´í”„ë¼ì¸ ì—°ì‚°ì
  group_by(class) %>%
  filter(row_number(desc(hwy)) == 1)

p <- ggplot(data = mpg,
            mapping = aes(x = displ, y = hwy))

p + geom_point(aes(color = class)) +
  
  geom_smooth(se = T) +
  
  labs(title = "Fuel efficiency .vs. engine size",
       x = "Engine displacement (L)", 
       subtitle = "Two seaters are exceptional",
       caption = "Data from fueleconomy.gov",
       y = "Highway fuel economy (mpg)", color = "Car Type") + # ì œëª©, ìº¡ì…˜, xì¶•, yì¶•, ë²”ë¡€ ì´ë¦„ ë³€ê²½
  
  geom_label(aes(label = model), # ìš”ì†Œì— ë¼ë²¨ ë‹¬ê¸°
               data = best.in.class, 
               nudge_y = 2, alpha = 0.5) + # ë¼ë²¨ ì´ë¦„ ë°•ìŠ¤ì¹˜ê¸°, íˆ¬ëª…ë„
  
  theme(legend.position = "right") + # ë²”ë¡€ ìœ„ì¹˜ ë°”ê¾¸ê¸° 
    
  theme_minimal() # ggplot í…Œë§ˆ ë³€ê²½
```

### ggsave

    â–ª ggsave(file="myplot.pdf") : pdfëŠ” í”½ì…€ ì•ˆê¹¨ì§.

    â–ª ggsave("ê²½ë¡œ/íŒŒì¼ëª….jpg.png.pdf", width = 1920, height = 1080, units = "px")

â–ª ë°ì´í„° ë¶„ì„ê³¼ ì‹œê°í™”ë¥¼ ìœ„í•œ ë„êµ¬:

    â€¢ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ì— ê¸°ë°˜í•œ ë„êµ¬
        - R: ggplot, Python: matplotlib, JavaScript: D3.js, etc.
    â€¢ ë¹„ì¦ˆë‹ˆìŠ¤ ì¸í…”ë¦¬ì „ìŠ¤ ë„êµ¬
        - Tableau, Microsoft Power BI, etc.

â–ª êµ¬ê¸€ íŠ¸ë Œë“œ, ë„¤ì´ë²„ ë©, ì¹´ì¹´ì˜¤ íŠ¸ë Œë“œ ë“±...

### í•œìŠ¤ ë¡œìŠ¬ë§

<https://www.gapminder.org/tools/#$chart-type=bubbles&url=v1>

# *R Gallery Book*

<https://www.r-graph-gallery.com/>

<https://bookdown.org/content/b298e479-b1ab-49fa-b83d-a57c2b034d49/>

```{r}
library(palmerpenguins)
pg <- penguins
pg <- pg[complete.cases(pg), ]
pg

pg %>%
  ggplot(aes(x = body_mass_g, fill = sex)) +
  geom_histogram(color = "e9ecf", alpha = 0.6, position = "identity") + 
  scale_fill_manual(values = c(#69)) + # 
  theme_linedraw() +
  labs(fill = "")
```

```{r}
# install.packages('esquisse')

# install.packages("gapminder")
library(gapminder)
str(gapminder)

ggplot(gapminder, 
aes(gdpPercap, lifeExp, color = continent)) +
geom_point(alpha = 0.5) +
scale_x_log10(labels = scales::dollar) +
labs(title = "GapMinder: GDP .vs. Life Expectancy",
x = "GDP per capita", y = "Life Expectancy") +
theme(plot.title = element_text(size=18,
face="bold",
color="steelblue"))

```
